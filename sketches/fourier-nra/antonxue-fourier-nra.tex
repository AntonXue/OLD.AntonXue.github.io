\documentclass[12pt]{article}

% Packages
\usepackage[margin=6em]{geometry} % 1 cm = 2.84528 em
\usepackage[colorlinks=true,linkcolor=red,urlcolor=blue]{hyperref}
\usepackage{tikz}
\usepackage[backend=bibtex]{biblatex}
\bibliography{sources}
\nocite{*}

\usepackage{lipsum}

% Paragraphs
\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% Includes
\input{antonxue-lib}

\let\H\undefined
\newcommand{\H}{\mathcal{H}}

\let\F\undefined
\newcommand{\F}{\mathcal{F}}

% Author
\title{Fourier Transforms for Non-linear Real Arithmetics}
\author{Anton Xue}
% \date{\today}
\date{}

% Document
\begin{document}
\maketitle

\subsection{The Problem(s)}
We first consider the satisfiability of first-order logic formulae over
non-linear real arithmetics:

\begin{align*}
  \varphi
    = \bigwedge_{i = 1}^{N} \parens{\bigvee_{j = 1}^{M}
        f_{i, j}\parens{\vec{x}} \leq \varepsilon_{i, j}}
  \qquad
  \vec{x} \in K \subseteq \R^n, \enskip
  \type{f_{i, j}}{K}{\R}, \enskip
  \varepsilon_{i, j} \geq 0
\end{align*}

The question of satisfiability, however, is undecidable:
we cannot yield algorithms that, given $\varphi$, is able to find some
$\vec{x}$ if there exists a satisfying configuration.
We thus seek to approximate solutions, which throws away soundness for
feasibility.

However, we are interested in still another class of problems:
program synthesis.
Given a pre-condition $P$ that we assume at the start of program execution,
and post-condition $Q$, does there exists some program $S$ that is able to
transform $P$ into $Q$?
When $P$ and $Q$ are formulae over linear integer arithmetics, for instance,
the corresponding program is akin to a sequence of variable assignments
that correspond to a linear transformation.
We never said these programs have to be fancy, did we?


\subsection{Background}
We provide a brief overview of the Fourier transform and the theory of linear
real arithmetics.

\subsubsection{The Fourier Transform}
Consider the separable Hilbert space $\H = L^2 \parens{\brackets{0, 1}}$
endowed with the Fourier basis $\braces{e_n}_{n \in \Z}$, where we define
$e_n \parens{x} = e^{i 2\pi n x}$.
A Fourier transform $\type{\F_n}{\H}{\C}$ is a linear functional that can
be expressed as an inner product:

\begin{align*}
  \F_n\brackets{f}
    = \inner{f, e_n}
    = \int_0^1 f\parens{x} \overline{e_n \parens{x}} dx
    = \int_0^1 f\parens{x} e^{-i 2 \pi n x} dx
\end{align*}

The partial Fourier series $\type{S_n}{\H}{\H}$ is a
(finite dimensional) compact operator:

\begin{align*}
  S_N \brackets{f} \parens{x}
    = \sum_{n = -N}^{N} \inner{f, e_n} e_n \parens{x}
    = \sum_{n = -N}^{N} e_n \parens{x} \int_0^1 f(y) e^{- i 2 \pi n y} dy
\end{align*}

Note that this is an orthogonal projection.
Consider some $m$ such that
$\abs{m} > N$:

\begin{align*}
  \inner{e_m, S_N}
    = \inner{e_m, \sum_{n = -N}^{N} \inner{f, e_n} e_n}
    = \sum_{n = -N}^{N} \inner{f, e_n} \cdot \inner{e_m, e_n}
    = \sum_{n = -N}^{N} \inner{f, e_n} \cdot 0
    = 0
\end{align*}

Furthermore, we omit the proof, but do note that this converges in norm
for any $f \in \mathcal{H}$:
\begin{align*}
  \lim_{N \to \infty} \norm{f - S_N \brackets{f}}_{\H}
    = \lim_{N \to \infty}
      \abs{f\parens{x} -
            \sum_{n = -N}^{N} \int_0^1 f\parens{x} e^{-i 2\pi nx} dx}
    \to 0
\end{align*}

We also remark that the class of continuous functions over
compact support are dense in $L^2$.
This motivates us to consider the problem of non-linear real arithmetics
over compact (perhaps convex?) domains.


\subsubsection{Multi-Dimensional Fourier Transform}
We now consider the Fourier transform when we consider $n$ dimensions.
Consider the vector $\vec{N} = \parens{N_1, \ldots, N_n} \in \Z^n$.
For $\H = L^2 \parens{\brackets{0, 1}^n}$,
we define as the orthonormal basis:

\begin{align*}
  \phi_{\vec{N}} \parens{x_1, \ldots, x_n}
    = \prod_{i = 1}^{n} e_{N_i} \parens{x_i}
    = e^{i 2 \pi \parens{N_1 x_1 + \cdots + N_n x_n}}
\end{align*}

We likewise define the
Fourier transform $\type{G_{\vec{N}}}{H}{H}$ as a
linear functional in the form of an inner product,
with $\vec{x} \in \R^n$:

\begin{align*}
  \mathcal{G}_{\vec{N}} \brackets{f} \parens{\vec{x}}
    = \inner{f, \phi_{\vec{N}}}
    = \int_{\brackets{0, 1}^n}
      f\parens{\vec{x}} \overline{\phi_{\vec{N}} \parens{\vec{x}}} d \vec{x}
\end{align*}

A multi-dimensional Fourier series is thus the following operator mapping:

\begin{align*}
  \mathcal{T}_{\vec{N}} \brackets{f}\parens{\vec{x}}
    = \sum_{i_1 = -N_1}^{N_1} \cdots \sum_{i_n = -N_n}^{N_n}
        \inner{f, \phi_{i_1, \ldots, i_n}} \phi_{i_1, \ldots, i_n} \parens{x}
\end{align*}

I am sure a proof of convergence in $L^2$ norm for this exists somewhere.


\subsubsection{Linear Real Arithmetics}
Linear real arithmetics is a restriction of non-linear real arithmetics
that we considered above.
Recall the following formula:

\begin{align*}
  \varphi
    = \bigwedge_{i = 1}^{N} \parens{\bigvee_{j = 1}^{M}
        f_{i, j}\parens{\vec{x}} \leq \varepsilon_{i, j}}
  \qquad
  \vec{x} \in K \subseteq \R^n, \enskip
  \type{f_{i, j}}{K}{\R}, \enskip
  \varepsilon_{i, j} \geq 0
\end{align*}

In \textbf{linear} real arithmetics, each inequality now has form:

\begin{align*}
  \varphi
    = \bigwedge_{i = 1}^{N} \parens{\bigvee_{j = 1}^{M}
        \parens{\sum_{k = 1}^{n} a_{i, j, k} x_k} \leq \varepsilon_{i, j}}
  \qquad
  \vec{x} = \parens{x_1, \ldots, x_n} \in K \subseteq \R^n, \enskip
  a_{i, j, k} \in \R, \enskip
  \varepsilon_{i, j} \geq 0
\end{align*}

Variants of this problem include cases when the disjunctions
are unit, which is equivalent to the problem of intersection finding for
halfspaces.
Convex optimization problems often take such form, and have elegant
theories and techniques.
However, the importance here is that the theory of linear real arithmetics
is decidable.


\subsection{The Idea}
We approach the problem of approximate satisfiability and synthesis
by linearized approximations.
For each $f_{i, j}$ in the boolean conjunction that makes up a
non-linear real arithmetic formula,
we may find Fourier series, whose coefficients are real.
Such a reduction yields a problem in the domain of real arithemtics, which
is decidable.
We test the approach, formalize it, and perform error analysis.

\subsubsection{Linearization}
We rewrite a formula over non-linear real arithmetics as follows:

\begin{align*}
  \varphi
    = \bigwedge_{i = 1}^{N} \parens{\bigvee_{j = 1}^{M}
      T_{\vec{N}} \brackets{f_{i,j}}\parens{\vec{x}}
      \leq T_{\vec{N}} \brackets{\varepsilon_{i,j}} \parens{\vec{x}}}
  \qquad
  \vec{x} \in K \subseteq \R^n, \enskip
  \vec{N} \in \Z^n, \enskip
  \type{f_{i, j}}{K}{\R}, \enskip
  \varepsilon_{i, j} \geq 0
\end{align*}

Because we have real-valued functions, we induce real-valued coefficients,
and this brings the problem back into a decidable theory.
We now investigate how well this may work:

\paragraph{Testing Stuff}
As a preliminary study we consider basic functions of the form:
\begin{align*}
  f_1 \parens{x} \leq x - \frac{1}{2}
  \qquad
  f_2 \parens{x} \geq \frac{x}{2} - \frac{1}{4}
  \qquad
  x \in \brackets{0, 1}
\end{align*}

This set of inequalities has a solution on $x \in \brackets{1/2, 1}$.
Taking their Fourier transforms:

\begin{align*}
  \mathcal{F}_n \brackets{f_1} \parens{x}
    = \frac{-i \pi  n+e^{i 2  \pi  n} (1-i \pi  n)-1}{4 \pi ^2 n^2}
  \qquad
  \mathcal{F}_n \brackets{f_2} \parens{x}
    = \frac{-i \pi  n+e^{i 2 \pi  n} (1-i \pi  n)-1}{8 \pi ^2 n^2}
\end{align*}

For constants, the Fourier transform yields zero.
We now examine the coefficients of the Fourier series generated by $f_1$
and $f_2$:


\begin{align}
  \begin{split}
    f_1 \mapsto \quad
      n = -5 & \mapsto \frac{1}{10 \pi} e^{\pi / 2} \\
      n = -4 & \mapsto \frac{1}{8 \pi} e^{\pi / 2} \\
      n = -3 & \mapsto \frac{1}{6 \pi} e^{\pi / 2} \\
      n = -2 & \mapsto \frac{1}{4 \pi} e^{\pi / 2} \\
      n = -1 & \mapsto \frac{1}{2 \pi} e^{\pi / 2} \\
      n = 0 & \mapsto \emptyset \\
      n = 1 & \mapsto \frac{1}{2 \pi} e^{- \pi / 2} \\
      n = 2 & \mapsto \frac{1}{4 \pi} e^{- \pi / 2} \\
      n = 3 & \mapsto \frac{1}{6 \pi} e^{- \pi / 2} \\
      n = 4 & \mapsto \frac{1}{8 \pi} e^{- \pi / 2} \\
      n = 5 & \mapsto \frac{1}{10 \pi} e^{- \pi / 2}
  \end{split}
  \begin{split}
    f_2 \mapsto \quad
      n = -5 & \mapsto \frac{1}{20 \pi} e^{\pi / 2} \\
      n = -4 & \mapsto \frac{1}{16 \pi} e^{\pi / 2} \\
      n = -3 & \mapsto \frac{1}{12 \pi} e^{\pi / 2} \\
      n = -2 & \mapsto \frac{1}{8 \pi} e^{\pi / 2} \\
      n = -1 & \mapsto \frac{1}{4 \pi} e^{\pi / 2} \\
      n = 0 & \mapsto \emptyset \\
      n = 1 & \mapsto \frac{1}{4 \pi} e^{- \pi / 2} \\
      n = 2 & \mapsto \frac{1}{8 \pi} e^{- \pi / 2} \\
      n = 3 & \mapsto \frac{1}{12 \pi} e^{- \pi / 2} \\
      n = 4 & \mapsto \frac{1}{16 \pi} e^{- \pi / 2} \\
      n = 5 & \mapsto \frac{1}{20 \pi} e^{- \pi / 2}
  \end{split}
\end{align}

\subsubsection{Program Synthesis}
TODO: The linear methods described in Kuncak, Victor, Mayer, Mika\"{e}l
and Piskac's paper is still applicable here.
But really we want a more custom LRA solution that I need to read up on.


\subsubsection{Error Analysis}
Oh fuck.

\subsubsection{Complexity Analysis}
Time consuming.

\subsubsection{Efficient Implementation}


\subsection{Remarks}



\printbibliography


\end{document}
