\documentclass[12pt]{article}

% Packages
\usepackage[margin=5em]{geometry} % 1 cm = 2.84528 em
\usepackage[backend=bibtex]{biblatex}
\bibliography{sources}
% \nocite{*}

\usepackage{lipsum}

% Paragraphs
\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% Includes
\input{antonxue-lib.tex}
\input{op-lib.tex}


% Author
\title{Operator Automata Theory}
% \author{Anton Xue}
% \date{\today}
\date{}

% Document
\begin{document}
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}

The goal of operator automata theory is to view automata is to
view automata as homomorphisms between linear spaces.
In this sketch we develop the basic theory and preliminary results.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}

\subsection{Notation}

\red{descriptive text here}

\subsection{Algebra}

\begin{definition}[Monoid]
  A monoid \(\parens{M, \cdot, \one}\) consists of a set \(M\) for which:
  \begin{enumerate}
    \item[(a)]
      Monoid multiplication
      \(\type{\cdot}{M \times M}{M}\) is associative.

    \item[(b)]
      The element \(\one \in M\) is the unique identity of multiplication.
  \end{enumerate}
\end{definition}

\begin{definition}[Semiring]
  A semiring \(\parens{R, +, \cdot, \zero, \one}\) consists of a set \(R\)
  for which:
  \begin{enumerate}
    \item[(a)]
      Semiring multiplication \(\type{\cdot}{R \times R}{R}\)
      distributes over semiring addition \(\type{+}{R \times R}{R}\).

    \item[(b)]
      \(\parens{R, +, \zero}\) is a commutative monoid.

    \item[(c)]
      \(\parens{R, \cdot, \one}\) is a monoid.

    \item[(d)]
      Multiplication by zero \(\zero\) annihilates \(R\).
  \end{enumerate}
\end{definition}

\begin{definition}[Semimodule]
  For a semiring \(R\), a \(R\)-semimodule
  \(\parens{M, +, \times, \zero}\)
  is such that:
  \begin{enumerate}
    \item[(a)]
      \(\parens{M, +, \zero}\) is a commutative group.

    \item[(b)]
      Scalar multiplication
      \(\type{\cdot}{R \times M}{M}\) is a semiring action on \(M\).

  \end{enumerate}
\end{definition}

\begin{definition}[Group]
  A group \(\parens{G, \cdot, \one}\) consists of a set \(G\) such that:
  \begin{enumerate}
    \item[(a)]
      Group multiplication \(\type{\cdot}{G \times G}{G}\) is associative.

    \item[(b)]
      \(\one\) is the identity under multiplication.

    \item[(c)]
      If \(a \in G\), then it has an inverse \(a^{-1} \in G\).
  \end{enumerate}
\end{definition}

\begin{definition}[Field]
  A field \(\parens{K, +, \cdot, \zero, \one}\) is a set \(K\) such that:
  \begin{enumerate}
    \item[(a)]
      Field multiplication \(\type{\cdot}{K \times K}{K}\)
      distributes over field addition \(\type{+}{K \times K}{K}\).

    \item[(b)]
      \(\parens{K, +, \zero}\) is a commutative group.

    \item[(c)]
      \(\parens{K, \cdot, \one}\) is a commutative group.

    \item[(d)]
      Multiplication by zero \(\zero\) annihilates \(K\).
  \end{enumerate}
\end{definition}

\begin{definition}[Linear Space]
  For a field \(K\),
  a \(K\)-linear space \(\parens{V, +, \cdot, \zero}\) over a field \(K\)
  is a set such that:
  \begin{enumerate}
    \item[(a)]
      \(\parens{V, +, \zero}\) is a commutative group.

    \item[(b)]
      Scalar multiplication
      \(\type{\cdot}{\K \times V}{V}\) is a field action on \(V\).

  \end{enumerate}
\end{definition}


\begin{definition}[Linear Operator]
  For \(K\)-linear spaces \(V\) and \(W\), a linear operator
  \(\type{T}{V}{W}\) is a homomorphism.
\end{definition}


\begin{definition}[Non-Deterministic Finite Automata]
  A non-deterministic finite automata (NFA)
  \(\parens{\Sigma, Q, \delta, S, F}\)
  is a finite state machine that accepts or rejects strings.
  A NFA reads from a tape of finite tape of cells in which each cell
  has a letter from the finite alphabet \(\Sigma\).
  At any point, the NFA is in some state \(Q\), and
  upon reading the current tape cell's contents
  the transition function \(\type{\delta}{\Sigma \times Q}{\powset{Q}}\)
  will transition the NFA non-deterministically to any one of
  the possible next states in addition to advancing to read the next cell.
  The set of start states \(S \subseteq Q\) is the set of states
  that the NFA may begin at,
  while the set of final states \(F \subseteq Q\) is the state of states
  that the NFA must be in in order to accept a string
  after reading the last letter on the tape.
\end{definition}


\begin{definition}[Metric Space]
  A metric space \(\parens{M, d}\) is a space \(M\) equipped with a
  metric function \(\type{d}{M \times M}{\Rz}\) such that:
  \begin{enumerate}
    \item[(a)]
      \(d\parens{x, y} = 0\) if and only if \(x = y\).

    \item[(b)]
      \(d\parens{x, y} = d\parens{y, x}\).

    \item[(c)]
      For all \(x, y, z \in M\),
      \(d\parens{x, z} \leq d\parens{x, y} + d\parens{x, z}\).
  \end{enumerate}
\end{definition}


\begin{definition}[Normed Space]
  A normed space \(\parens{V, \norm{\cdot}}\) is a \(K\)-linear space \(V\)
  equipped with a norm function \(\type{\norm{\cdot}}{V}{\Rz}\) such that:
  \begin{enumerate}
    \item[(a)]
      For all \(x, y \in V\), \(\norm{x + y} \leq \norm{x} + \norm{y}\).

    \item[(b)]
      For all \(a \in K\) and \(x \in V\),
      \(\norm{ax} = \abs{a} \cdot \norm{x}\).

    \item[(c)]
      For \(\zero \in V\), \(\norm{\zero} = 0\).
  \end{enumerate}
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Automata as Operators}

We leverage some of the algebraic sections previously discussed to
construct representations relevant to us.

\subsection{Algebraic Structures of Automata}

For a NFA \(A\), with \(A = \parens{\Sigma, Q, \delta, S, F}\),
the goal is to view \(A\) acting as a linear operator between spaces.
In particular, the approach we take is to see \(\delta\) as a
linear operator between spaces: this is perhaps the most obvious approach,
because to begin with, \(\delta\) is already the transition function.

But the questions are then:
what are the appropriate linear spaces,
and what are the actions of the linear operator?
One initial thought is that the transition function can, in some way,
be seen as a directed acyclic graph on the states \(Q\),
where each edge is weighted by the letters in the alphabet \(\Sigma\)
that induce the transition.
The representation as an adjacency matrix does appear in
literature~\cite{savage1998models}.
Roughly, if \(M\) is the transition matrix, then \(M_{i, j} \in 2^{\Sigma}\)
denotes the states that will transition state \(q_i\) to \(q_j\).

While such a matrix representation is useful,
it is not immediately obvious how such a matrix does indeed correspond
to a linear operator, especially on what linear spaces.
One possible interpretation is to see
the linear spaces as \(\abs{Q}\)-dimensional,
where each dimension of the space corresponds to one member of \(Q\).
The objects of the space is then sets of strings over \(\Sigma\).

\begin{definition}[String Space]
  The string space of \(\Sigma\) is a semiring
  \(\parens{2^{\Sigma^\star}, \cup, \cdot, \zero, \one}\)
  such that:
  \begin{enumerate}
    \item[(a)]
      The semiring addition is the set union
      \(\type{\cup}{2^{\Sigma^\star} \times
        2^{\Sigma^\star}}{2^{\Sigma^\star}}\).

    \item[(b)]
      The semiring multiplication is the string concatenation
      \(\type{\cdot}{2^{\Sigma^\star} \times
        2^{\Sigma^\star}}{2^{\Sigma^\star}}\)
      such that:
      \begin{align*}
        A \cdot B
          = \braces{a \cdot b \st a \in A, b \in B}
      \end{align*}
  \end{enumerate}
\end{definition}

Here the string space is the power set of all strings generated
by \(\Sigma\) through monoid multiplication (string concatenation).
Defining the string space like this allows us to equip it with a semiring
structure by viewing addition as set union.
For convenience,
we may write \(R\) instead of \(2^{\Sigma^\star}\)
to denote the set corresponding to the string space.

Observe that \(R\) has the structure of a \(1\)-dimensional linear space.
The big difference, however, is that the scalar elements are
elements of a semiring rather than a field.
Nevertheless, \(R\) is still closed under linear operations,
and is therefore a linear space.

\begin{theorem}
  A string space \(R\) is a linear space.
\end{theorem}
\begin{proof}
  \red{descriptive text here}
\end{proof}

The natural extension of a \(1\)-dimensional linear space
is a \(n\)-dimensional linear space.

\begin{definition}[\(n\)-String Space]
  For a string space \(R\) and \(n \in \Zp\),
  the \(n\)-dimensional string space \(R^n\) is then the
  free semimodule isomorphic to \(n\) copies of \(R\).
\end{definition}

A natural representation of \(R^n\) is as a \(n\)-dimensional vector,
and in this case we prefer row vectors to column vectors.
We abuse notation to identify elements of \(R^n\) with their
row vector representation.
Furthermore, we demonstrate that this is indeed still a linear space.

\begin{theorem}
  A string space \(R^n\) is a linear space.
\end{theorem}
\begin{proof}
  \red{descriptive text}
\end{proof}

In particular, it would be nice to have a linear operator
between string spaces.

\begin{definition}[Linear String Space Operator]
  A linear string space operator
  is a linear operator \(\type{A}{R^n}{R^m}\).
\end{definition}

In particular, we are interested in a matrix representation.

\begin{definition}[Matrix Representation of Linear String Space Operator]
  The matrix representation of a linear string space operator
  \(\type{A}{R^n}{R^m}\) is a matrix
  \(A \in M_{n \times m} \parens{R}\) that
  acts on row vectors of \(R^n\) by right multiplication.
\end{definition}

Here each entry of the matrix denotes the sets strings that are
concatenated during transition.
As with the \(n\)-dimensional string space \(R^n\),
we abuse notation for \(A\) to stand in for
both the linear operator and its matrix representation.
We now show that this is indeed a linear operator.

\begin{theorem}
  The matrix representation of \(\type{A}{R^n}{R^m}\) is a linear operator.
\end{theorem}
\begin{proof}
  \red{descriptive text}
\end{proof}

Observe that the elements for the matrix of \(A\) are drawn from
\(R\) (which is just \(2^{\Sigma^\star}\))
rather than \(2^{\Sigma}\),
which is what we would expect for an NFA.
In other words, transitions in \(A\) are given by sets of potentially
long strings, rather than just single alphabets.
The definition provided here is intended to be slightly more general,
with the NFA case of single-letter transitions being a special case.
Nevertheless,
given a NFA, we are now ready to describe a particular matrix representation
as a linear operator between \(n\)-string spaces.

\begin{definition}[Matrix Representation of \(\delta\)]
  For a NFA \(\parens{\Sigma, Q, \delta, S, F}\) with
  string space \(R\) generated by \(\Sigma\) and \(n = \abs{Q}\),
  the matrix representation of \(\delta\) as a linear operator
  is a matrix
  \(A \in M_{n \times n} \parens{R}\)  where:
  \begin{align*}
    A_{i, j}
      = \braces{a \st \parens{\parens{a, q_i}, B} \in \delta, q_j \in B}
  \end{align*}
\end{definition}

Of course, this is a linear string space operator simply because
every entry of the transition matrix will be a set of singleton strings.



\subsection{Examples}

\begin{example}
  Consider \(\Sigma = \braces{a, b, c}\) and the NFA below:

  \begin{figure}[h!]
  \centering
  \begin{tikzpicture}
    [->,
     >=stealth',
     shorten >=1pt,
     auto,
     node distance=2cm,
     semithick,
     state/.style={circle, draw, minimum size=1cm} 
    ]
    \node[state] (Q1) at (0, 0) {\(q_1\)};
    \node[state] (Q2) at (3, 1.5) {\(q_2\)};
    \node[state] (Q3) at (3, -1.5) {\(q_3\)};

    \path (Q1) edge [] node
              {\(\braces{a, b}\)} (Q2);
    \path (Q2) edge [loop right] node
              {\(\braces{a}\)} (Q2);
    \path (Q2) edge [] node
              {\(\braces{b}\)} (Q3);
    \path (Q3) edge [loop right] node
              {\(\braces{a, c}\)} (Q3);
    \path (Q3) edge [] node
              {\(\braces{c}\)} (Q1);
  \end{tikzpicture}
  \caption{NFA Graph}
  \end{figure}
  The most important distinction between this and a typical
  NFA is that we implicitly assume every state to be both starting
  and accepting.
  In other words, accepting strings is very permissive,
  which simplifies things for now.
  However,
  to embed this into our model there are several steps.

  First, we have the string space
  \(\parens{2^{\Sigma^\star}, \bigcup, \cdot, \zero, \one}\).

  Next, for the matrix \(A\) that we will construct,
  take \(A_{i, j}\) to denote the transition from state
  \(q_i\) to state \(q_j\).
  The matrix is then:
  \begin{align*}
    A =
      \begin{bmatrix}
        \zero & \braces{a, b} & \zero \\
        \zero & \braces{a} & \braces{b} \\
        \braces{c} & \zero & \braces{a, c}
      \end{bmatrix}
  \end{align*}
  In order to perform string concatenation towards the right,
  transition matrices act by right-matrix multiplication.
  That is, if \(v \in R^3\) is the initial \(n\)-dimensional
  string space, then the subsequent string space is \(v A\).

  To briefly demonstrate, two transitions of the matrix \(A\) appears as
  follows:
  \begin{align*}
    A^2 =
      \begin{bmatrix}
        \zero & \braces{a, b} & \zero \\
        \zero & \braces{a} & \braces{b} \\
        \braces{c} & \zero & \braces{a, c}
      \end{bmatrix} 
      \begin{bmatrix}
        \zero & \braces{a, b} & \zero \\
        \zero & \braces{a} & \braces{b} \\
        \braces{c} & \zero & \braces{a, c}
      \end{bmatrix}
      =
      \begin{bmatrix}
        \zero & \braces{aa, ba} & \braces{ab, bb} \\
        \braces{bc} & \braces{aa} & \braces{ab, ba, bc} \\
        \braces{ac, cc} & \braces{ca, cb} & \braces{aa, ac, ca, cc}
      \end{bmatrix}
  \end{align*}
  In general, from graph theory, \(A^k\) denotes the \(k\)th consecutive
  transition using \(A\),
  and each entry \(A^k _{i, j}\) is the set of strings that will
  get from state \(q_i\) to \(q_j\) in \(k\) steps.

\end{example}


\section{Automata Metrics}
Having established a method for embedding NFA in linear spaces,
our attention now turns to comparing them.
In short, we are interested in finding how similar the strings
recognized by two NFAs are.

\subsection{Measures and Metrics}
We leverage previous work in defining a measure,
and only provide some definitions here.
We borrow heavily from previous work in ~\cite{xue2018langmeasures}.

\begin{definition}[String Space Measure]
  Let
  \(\parens{\Sigma^\star, \sigma\parens{\Sigma^\star}}\)
  be a measurable space defined on the strings \(\Sigma^\star\).
  If \(\type{\lambda}{\sigma\parens{\Sigma^\star}}{\Rz}\) is a measure,
  then we call it a string space measure,
  and the measure space
  \(\parens{\Sigma^\star, \sigma\parens{\Sigma^\star}, \lambda}\)
  a string measure space.
\end{definition}

The elements of a string measure space consists of strings finite,
while the \(\sigma\)-algebra generated consists of sets of finite strings.
A measure \(\type{\lambda}{\sigma\parens{\Sigma^\star}}{\Rz}\) is also
equipped, and may be defined.

We have also shown previously~\cite{xue2018langmeasures} that
measures are able to define a metric.

\begin{definition}[String Space Metric]
  Let
  \(\parens{\Sigma^\star, \sigma\parens{\Sigma^\star}, \lambda}\)
  be a string measure space.
  The string metric space \(\parens{\powset{\Sigma^\star}, \zeta}\) is
  a metric space with a metric function
  \(\type{\zeta}{\powset{\Sigma^\star} \times \powset{\Sigma^\star}}{\Rz}\)
  defined as:
  \begin{align*}
    \zeta \parens{A, B}
      = \lambda\parens{A \triangle B}
  \end{align*}
\end{definition}
\begin{theorem}
  The string space metric function
  \(\type{\zeta}{\powset{\Sigma^\star} \times \powset{\Sigma^\star}}{\Rz}\)
  is a metric function.
\end{theorem}
\begin{proof}
  \red{descriptive text}
\end{proof}

Recall that although we write \(\powset{\Sigma^\star}\) here,
they are synonymous with \(R\).
Having defined a metric on string spaces,
we are interested in examining how we may compare two linear operators
between string spaces.
In other words, for two operators
\(\type{A_1, A_2}{R^n}{R^m}\), it is possible that
the two are isomorphic up to some permutation.
Note that we want to consider the special case of \(n = m\) first,
for which theories of permutation matrix related to
graph isomorphism are well-developed.
After all, we are focused on NFAs here,
which have nice an straightforward graph representations.

\begin{theorem}[Square Operator Permutation]
  Let \(P_n \subseteq M_{n \times n}\parens{R}\)
  denote the family of \(n\)-dimensional permutation matrices.
  Two linear operators
  \(\type{A_1, A_2}{R^n}{R^n}\) are isomorphic if
  there is a permutation matrix
  \(P \in P_n\) such that:
  \begin{align*}
    A_1 = P A_2 \transp{P}
  \end{align*}
\end{theorem}
\begin{proof}
  \red{descriptive text}
\end{proof}

Permutation matrices give us the ability to talk about
isomorphisms up to permutation.
However they lack the ability to about how similar two operators might be.
To do this, for two operators of the same dimensions,
we may be interested in seeing how far the image of the operators
in each dimension differ.
Without permutation matrices
for two linear operators \(A, B\), we may try something like this:
\begin{align*}
  \sup_{1 \leq i, j \leq n}
    \zeta\parens{A_{i, j}, B_{i, j}}
\end{align*}
In other words, we find entries of the matrix that yield the most distance
with respect to the \(\zeta\) string space metric function.
With permutation matrices, we may try something like this:
\begin{align*}
  \inf_{P \in P_n} \sup_{1 \leq i, j \leq n}
    \zeta\parens{A_{i, j}, B_{i, j}}
\end{align*}
This is fairly straightforward, and more or less just amounts to saying
to take the best permutation of one of the operators with respect
to the other, and then take the distance with respect to
\(\zeta\).

However, there are still several concerns here.
First, we need to generalize this to cases where
\(A\) and \(B\) are not the same dimension.
In addition, we are not completely sure if taking the infimum of
\(P \in P_n\) retains a metric structure,
which means that such an operation may need to be defined with respect
to a fixed permutation matrix.

We first consider how square operators of different dimensions may be compared.

\begin{definition}[Linear Operator Dimension]
  Let \(\type{A}{R^n}{R^n}\) be a square linear string space operator.
  For \(m > n\),
  the dimension extension of \(A\)
  is a square linear operator \(\type{\overline{A}}{R^m}{R^m}\)
  whose matrix representation has form:
  \begin{align*}
    \overline{A} = \begin{bmatrix} A & \zero \\ \zero & \zero \end{bmatrix}
  \end{align*}
\end{definition}

Although the newly appended dimensions of operator action
effectively have trivial action, this still acts as an embedding into
a higher dimension.
With this, we then attempt to define a metric between
two square linear operators of different dimensions:
\begin{definition}[Non-Uniform Dimension Square Linear Operator Metric]
  For two square linear operators
  \(\type{A}{R^n}{R^n}\) and \(\type{B}{R^m}{R^m}\) where \(m > n\),
  fix the permutation matrix \(P \in P_m\),
  define the operator metric
  \(\type{Z_{p, n, m}}
      {\parens{R^n \to R^n} \times \parens{R^m \to R^m}}{\Rz}\) as:
  \begin{align*}
    Z_{p, n, m}\parens{A, B} =
      \sup_{1 \leq i, j \leq m}
        \zeta\parens{\overline{A}_{i, j}, \parens{PB\transp{P}}_{i, j}}
  \end{align*}
\end{definition}
In short, when given two square linear operators
\(A\) and \(B\) where \(A\)
is a smaller dimension than \(B\), the goal of the metric function \(Z\)
is to first stretch \(A\) into \(\overline{A}\)
to match the dimension of \(B\),
and then apply the supremum coordinate-wise metric
on \(\overline{A}\) and \(B\).

\begin{theorem}
  The function
  \(\type{Z_{p, n, m}}
      {\parens{R^n \to R^n} \times \parens{R^m \to R^m}}{\Rz}\) 
  defined above is a metric.
\end{theorem}
\begin{proof}
  Once the permutation matrix \(P \in P_m\) is fixed, this reduces to
  applying the supremum over a finite set of metric functions
  for each entry of the matrix.
\end{proof}

The challenge, of course, is finding the correct permutation matrix \(P\).


\subsection{Examples}

\begin{example}
  Consider \(\Sigma = \braces{a, b, c}\) and two NFAs defined below:

  \begin{figure}[h!]
  \centering
  \begin{minipage}{0.45\textwidth}
  \begin{tikzpicture}
    [->,
     >=stealth',
     shorten >=1pt,
     auto,
     node distance=2cm,
     semithick,
     state/.style={circle, draw, minimum size=1cm} 
    ]
    \node[state] (Q1) at (0, 0) {\(q_1\)};
    \node[state] (Q2) at (3, 1.5) {\(q_2\)};
    \node[state] (Q3) at (3, -1.5) {\(q_3\)};

    \path (Q1) edge [] node
              {\(\braces{a}\)} (Q2);
    \path (Q2) edge [loop above] node
              {\(\braces{b}\)} (Q2);
    \path (Q2) edge [] node
              {\(\braces{a}\)} (Q3);
    \path (Q3) edge [] node
              {\(\braces{c}\)} (Q1);
  \end{tikzpicture}
  \caption{NFA \(A\)}
  \end{minipage}%
  \begin{minipage}{0.45\textwidth}
  \begin{tikzpicture}
    [->,
     >=stealth',
     shorten >=1pt,
     auto,
     node distance=2cm,
     semithick,
     state/.style={circle, draw, minimum size=1cm} 
    ]
    \node[state] (Q1) at (0, 0) {\(q_2\)};
    \node[state] (Q2) at (3, 1.5) {\(q_3\)};
    \node[state] (Q3) at (3, -1.5) {\(q_4\)};
    \node[state] (Q4) at (6, 0) {\(q_1\)};
  

    \path (Q1) edge [] node
              {\(\braces{a}\)} (Q2);
    \path (Q2) edge [loop above] node
              {\(\braces{b}\)} (Q2);
    \path (Q2) edge [] node
              {\(\braces{a}\)} (Q3);
    \path (Q3) edge [] node
              {\(\braces{c}\)} (Q1);
    \path (Q2) edge [] node
              {\(\braces{c}\)} (Q4);
    \path (Q4) edge [] node
              {\(\braces{a}\)} (Q3);

  \end{tikzpicture}
  \caption{NFA \(B\)}
  \end{minipage}
  \end{figure}
  The respective transition matrices are then:
  \begin{align*}
    A =
      \begin{bmatrix}
        \zero & \braces{a} & \zero \\
        \zero & \braces{b} & \braces{a} \\
        \braces{c} & \zero & \zero
      \end{bmatrix}
    \qquad
    \overline{A} =
      \begin{bmatrix}
        \zero & \braces{a} & \zero & \zero \\
        \zero & \braces{b} & \braces{a} & \zero \\
        \braces{c} & \zero & \zero & \zero \\
        \zero & \zero & \zero & \zero
      \end{bmatrix}
    \qquad
    B =
      \begin{bmatrix}
        \zero & \zero & \zero & \braces{a} \\
        \zero & \zero & \braces{a} & \zero \\
        \braces{c} & \zero & \braces{b} & \braces{a} \\
        \zero & \braces{c} & \zero & \zero
      \end{bmatrix}
  \end{align*}

  The corresponding permutation matrix is:
  \begin{align*}
    P =
      \begin{bmatrix}
        \zero & \one & \zero & \zero \\
        \zero & \zero & \one & \zero \\
        \zero & \zero & \zero & \one \\
        \one & \zero & \zero & \zero
      \end{bmatrix}
  \end{align*}
  Indeed, we have:
  \begin{align*}
    PB\transp{P}
    =
      \begin{bmatrix}
        \zero & \one & \zero & \zero \\
        \zero & \zero & \one & \zero \\
        \zero & \zero & \zero & \one \\
        \one & \zero & \zero & \zero
      \end{bmatrix}
      \begin{bmatrix}
        \zero & \zero & \zero & \braces{a} \\
        \zero & \zero & \braces{a} & \zero \\
        \braces{c} & \zero & \braces{b} & \braces{a} \\
        \zero & \braces{c} & \zero & \zero
      \end{bmatrix}
      \begin{bmatrix}
        \zero & \zero & \zero & \one \\
        \one & \zero & \zero & \zero \\
        \zero & \one & \zero & \zero \\
        \zero & \zero & \one & \zero
      \end{bmatrix}
    =
      \begin{bmatrix}
        \zero & \braces{a} & \zero & \zero \\
        \zero & \braces{b} & \braces{a} & \braces{c} \\
        \braces{c} & \zero & \zero & \zero \\
        \zero & \zero & \braces{a} & \zero
      \end{bmatrix}
  \end{align*}
  If we proceed with the metric \(\zeta\) calculation
  (assuming a counting measure) at each entry.
  We find the most significant differences occur
  at row-column index pairs \(\parens{2, 4}\) and \(\parens{4, 3}\):
  \begin{align*}
    \zeta_{\parens{2, 4}}\parens{\overline{A}_{2, 4},
           \parens{PB\transp{P}}_{2, 4}}
      = \zeta_{\parens{2, 4}}\parens{\zero, \braces{c}} = 1
    \qquad
    \zeta_{\parens{4, 3}} \parens{\overline{A}_{4, 3},
           \parens{PB\transp{P}}_{4, 3}}
      = \zeta_{\parens{4, 3}}\parens{\zero, \braces{a}} = 1
  \end{align*}

\end{example}





\pagebreak

\printbibliography

\end{document}

